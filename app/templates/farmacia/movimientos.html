{% extends "base.html" %}

{% block content %}
<h3 class="text-primary">Movimientos de Almac√©n a Farmacia</h3>

{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    {% for category, message in messages %}
      <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
        {{ message }}
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>
    {% endfor %}
  {% endif %}
{% endwith %}

<table class="table table-striped table-bordered">
  <thead class="table-dark">
    <tr>
      <th>Medicamento</th>
      <th>Cantidad</th>
      <th>Fecha Movimiento</th>
      <th>Usuario</th>
      <th>Observaciones</th>
    </tr>
  </thead>
  <tbody>
    {% for mov in movimientos %}
    <tr>
      <td>{{ mov.medicamento.nombre_comercial }}</td>
      <td>{{ mov.cantidad }}</td>
      <td>{{ mov.fecha_movimiento.strftime('%d/%m/%Y %H:%M') }}</td>
      <td>{{ mov.usuario.usuario }}</td>
      <td>{{ mov.observaciones or '-' }}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<a href="{{ url_for('farmacia.nuevo_movimiento') }}" class="btn btn-success mt-3">
  <i class="bi bi-plus-square"></i> Nuevo Movimiento
</a>
<!-- 4. TRANSFERENCIAS ENTRE UNIDADES -->
    <a href="{{ url_for('farmacia.listar_transferencias') }}" class="btn btn-sm btn-outline-dark">
      <i class="bi bi-arrow-repeat"></i> Transferencias
    </a>
 <a href="{{ url_for('farmacia.index') }}" class="btn btn-secondary">Regresar</a>
{% endblock %}
