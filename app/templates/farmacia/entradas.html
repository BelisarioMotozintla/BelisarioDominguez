{% extends "base.html" %}

{% block content %}
<h3 class="text-success">Entradas al Almac√©n</h3>

{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    {% for category, message in messages %}
      <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
        {{ message }}
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>
    {% endfor %}
  {% endif %}
{% endwith %}

<table class="table table-striped table-bordered">
  <thead class="table-dark">
    <tr>
      <th>Medicamento</th>
      <th>Cantidad</th>
      <th>Lote</th>
      <th>Fecha Caducidad</th>
      <th>Fecha Entrada</th>
      <th>Proveedor</th>
      <th>Usuario</th>
      <th>Observaciones</th>
    </tr>
  </thead>
  <tbody>
    {% for entrada in entradas %}
    <tr>
      <td>{{ entrada.medicamento.nombre_comercial }}</td>
      <td>{{ entrada.cantidad }}</td>
      <td>{{ entrada.lote or '-' }}</td>
      <td>{{ entrada.fecha_caducidad.strftime('%d/%m/%Y') if entrada.fecha_caducidad else '-' }}</td>
      <td>{{ entrada.fecha_entrada.strftime('%d/%m/%Y %H:%M') if entrada.fecha_entrada else '-' }}</td>
      <td>{{ entrada.proveedor or '-' }}</td>
      <td>{{ entrada.usuario.usuario }}</td>
      <td>{{ entrada.observaciones or '-' }}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<a href="{{ url_for('farmacia.nueva_entrada') }}" class="btn btn-success mt-3">
  <i class="bi bi-plus-square"></i> Nueva Entrada
</a>
 <a href="{{ url_for('farmacia.index') }}" class="btn btn-secondary">Cancelar</a>

{% endblock %}
